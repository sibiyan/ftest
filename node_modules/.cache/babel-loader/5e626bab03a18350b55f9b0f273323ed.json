{"ast":null,"code":"import _toConsumableArray from \"/Users/swalihvpm/Desktop/django-react/LD-gcloud/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/swalihvpm/Desktop/django-react/LD-gcloud/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/swalihvpm/Desktop/django-react/LD-gcloud/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/swalihvpm/Desktop/django-react/LD-gcloud/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/swalihvpm/Desktop/django-react/LD-gcloud/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/swalihvpm/Desktop/django-react/LD-gcloud/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/swalihvpm/Desktop/django-react/LD-gcloud/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/swalihvpm/Desktop/django-react/LD-gcloud/src/components/ld/localityList/main.jsx\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Helmet } from \"react-helmet\";\nimport \"../../common/index.scss\";\nimport Slider from \"react-slick\";\nimport { Link } from \"react-router-dom\";\nimport { Slider3 } from \"../../../services/script\";\nimport { AddToFavoritePlacesURL } from \"../../../constants\";\nimport { authAxios } from \"../../../authAxios\";\nimport { toast, ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport Search from \"./search\";\nimport { placeListURL } from \"../../../constants\";\n\nvar LocalityList =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(LocalityList, _React$PureComponent);\n\n  function LocalityList(props) {\n    var _this;\n\n    _classCallCheck(this, LocalityList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(LocalityList).call(this, props));\n\n    _this.fetchlaces = function () {\n      _this.setState({\n        loading: true\n      }, function () {\n        var _this$state = _this.state,\n            offset = _this$state.offset,\n            limit = _this$state.limit,\n            query = _this$state.query; // console.log(query);\n\n        axios.get(placeListURL + \"?limit=\".concat(limit, \"&offset=\").concat(offset, \"&q=\").concat(query)).then(function (res) {\n          var newLocalities = res.data.places;\n          var hasMore = res.data.has_more;\n\n          _this.setState({\n            hasMore: hasMore,\n            loading: false,\n            localities: _toConsumableArray(_this.state.localities).concat(_toConsumableArray(newLocalities)),\n            newLocalities: res.data.places,\n            offset: offset + limit\n          });\n        }).catch(function (err) {\n          _this.setState({\n            error: err.message,\n            loading: false\n          });\n        });\n      });\n    };\n\n    _this.setQuery = function (e) {\n      _this.setState({\n        query: e.target.value\n      });\n\n      _this.callbacktest();\n    };\n\n    _this.callbacktest = function () {\n      console.log(_this.state.query);\n    };\n\n    _this.handleSearch = function (e) {\n      e.preventDefault();\n\n      _this.fetchlaces();\n    };\n\n    _this.addToWishList = function (place) {\n      _this.setState({\n        loading: true\n      });\n\n      authAxios // .post(AddToFavoritePlacesURL  { shop })\n      .post(AddToFavoritePlacesURL, {\n        place: place\n      }).then(function (res) {\n        _this.setState({\n          loading: false\n        });\n\n        toast.success(\"This locality added to your favorites\");\n      }).catch(function (err) {\n        _this.setState({\n          error: err,\n          loading: false\n        });\n\n        toast.error(\"This locality already exists in your favorites\");\n      });\n    };\n\n    _this.state = {\n      loading: false,\n      error: null,\n      localities: [],\n      // journals: [],\n      hasMore: true,\n      offset: 0,\n      limit: 2,\n      query: \"all\",\n      newLocalities: []\n    };\n\n    window.onscroll = function () {\n      var _assertThisInitialize = _assertThisInitialized(_assertThisInitialized(_this)),\n          fetchlaces = _assertThisInitialize.fetchlaces,\n          _assertThisInitialize2 = _assertThisInitialize.state,\n          error = _assertThisInitialize2.error,\n          loading = _assertThisInitialize2.loading,\n          hasMore = _assertThisInitialize2.hasMore;\n\n      if (error || loading || !hasMore) return;\n\n      if (document.documentElement.scrollHeight - document.documentElement.scrollTop === document.documentElement.clientHeight) {\n        // call some loading method\n        fetchlaces();\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(LocalityList, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.fetchlaces();\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.getElementById(\"color\").setAttribute(\"href\", \"#\"); // this.fetchlaces();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state2 = this.state,\n          localities = _this$state2.localities,\n          query = _this$state2.query,\n          hasMore = _this$state2.hasMore; // console.log(localities, query, hasMore);\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, React.createElement(Helmet, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(\"title\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, \"Local Dukans\")), React.createElement(ToastContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }), React.createElement(Search, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"title4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), React.createElement(\"h2\", {\n        className: \"title-inner4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, \" Localities\"), React.createElement(\"div\", {\n        className: \"line\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      })))))), localities && React.createElement(\"section\", {\n        className: \"banner-furniture absolute_banner ratio3_2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row partition3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, localities.map(function (locality) {\n        return React.createElement(\"div\", {\n          key: locality.id,\n          className: \"col-md-4\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"collection-banner p-left text-left\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"img-wrapper\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: \"\".concat(process.env.PUBLIC_URL, \"/places/\").concat(locality.id),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          // src={`${process.env.PUBLIC_URL}/assets/images/fashion/banner/8.jpg`}\n          src: \"https://image.freepik.com/free-photo/river-foggy-mountains-landscape_1204-511.jpg\",\n          alt: \"\",\n          className: \"img-fluid blur-up lazyload bg-img\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          className: \"absolute-contain\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }, React.createElement(\"h3\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161\n          },\n          __self: this\n        }, locality.name), React.createElement(\"h4\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, \"Village: \", locality.village_name), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170\n          },\n          __self: this\n        }, React.createElement(\"a\", {\n          onClick: function onClick() {\n            return _this2.addToWishList(locality.id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"fa fa-heart fa-2x\",\n          style: {\n            color: \"#81ba00\"\n          },\n          \"aria-hidden\": \"true\" // onClick={() => this.addToWishList(locality.id)}\n          ,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        })))))));\n      })))));\n    }\n  }]);\n\n  return LocalityList;\n}(React.PureComponent);\n\nexport default LocalityList;","map":{"version":3,"sources":["/Users/swalihvpm/Desktop/django-react/LD-gcloud/src/components/ld/localityList/main.jsx"],"names":["React","Component","axios","Helmet","Slider","Link","Slider3","AddToFavoritePlacesURL","authAxios","toast","ToastContainer","Search","placeListURL","LocalityList","props","fetchlaces","setState","loading","state","offset","limit","query","get","then","res","newLocalities","data","places","hasMore","has_more","localities","catch","err","error","message","setQuery","e","target","value","callbacktest","console","log","handleSearch","preventDefault","addToWishList","place","post","success","window","onscroll","document","documentElement","scrollHeight","scrollTop","clientHeight","getElementById","setAttribute","map","locality","id","process","env","PUBLIC_URL","name","village_name","color","PureComponent"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,QAAuB,cAAvB;AACA,OAAO,yBAAP;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,SAASC,OAAT,QAAwB,0BAAxB;AACA,SAASC,sBAAT,QAAuC,oBAAvC;AACA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,KAAT,EAAgBC,cAAhB,QAAsC,gBAAtC;AACA,OAAO,uCAAP;AAEA,OAAOC,MAAP,MAAmB,UAAnB;AACA,SAASC,YAAT,QAA6B,oBAA7B;;IAEMC,Y;;;;;AACJ,wBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,sFAAMA,KAAN;;AADiB,UAuCnBC,UAvCmB,GAuCN,YAAM;AACjB,YAAKC,QAAL,CAAc;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAAd,EAAiC,YAAM;AAAA,0BACJ,MAAKC,KADD;AAAA,YAC7BC,MAD6B,eAC7BA,MAD6B;AAAA,YACrBC,KADqB,eACrBA,KADqB;AAAA,YACdC,KADc,eACdA,KADc,EAErC;;AACAnB,QAAAA,KAAK,CACFoB,GADH,CACOV,YAAY,oBAAaQ,KAAb,qBAA6BD,MAA7B,gBAAyCE,KAAzC,CADnB,EAEGE,IAFH,CAEQ,UAAAC,GAAG,EAAI;AACX,cAAMC,aAAa,GAAGD,GAAG,CAACE,IAAJ,CAASC,MAA/B;AACA,cAAMC,OAAO,GAAGJ,GAAG,CAACE,IAAJ,CAASG,QAAzB;;AACA,gBAAKb,QAAL,CAAc;AACZY,YAAAA,OAAO,EAAPA,OADY;AAEZX,YAAAA,OAAO,EAAE,KAFG;AAGZa,YAAAA,UAAU,qBAAM,MAAKZ,KAAL,CAAWY,UAAjB,4BAAgCL,aAAhC,EAHE;AAIZA,YAAAA,aAAa,EAAED,GAAG,CAACE,IAAJ,CAASC,MAJZ;AAKZR,YAAAA,MAAM,EAAEA,MAAM,GAAGC;AALL,WAAd;AAOD,SAZH,EAaGW,KAbH,CAaS,UAAAC,GAAG,EAAI;AACZ,gBAAKhB,QAAL,CAAc;AACZiB,YAAAA,KAAK,EAAED,GAAG,CAACE,OADC;AAEZjB,YAAAA,OAAO,EAAE;AAFG,WAAd;AAID,SAlBH;AAmBD,OAtBD;AAuBD,KA/DkB;;AAAA,UAiEnBkB,QAjEmB,GAiER,UAAAC,CAAC,EAAI;AACd,YAAKpB,QAAL,CAAc;AAAEK,QAAAA,KAAK,EAAEe,CAAC,CAACC,MAAF,CAASC;AAAlB,OAAd;;AACA,YAAKC,YAAL;AACD,KApEkB;;AAAA,UAsEnBA,YAtEmB,GAsEJ,YAAM;AACnBC,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAKvB,KAAL,CAAWG,KAAvB;AACD,KAxEkB;;AAAA,UA0EnBqB,YA1EmB,GA0EJ,UAAAN,CAAC,EAAI;AAClBA,MAAAA,CAAC,CAACO,cAAF;;AACA,YAAK5B,UAAL;AACD,KA7EkB;;AAAA,UA+EnB6B,aA/EmB,GA+EH,UAAAC,KAAK,EAAI;AACvB,YAAK7B,QAAL,CAAc;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAAd;;AACAT,MAAAA,SAAS,CACP;AADO,OAENsC,IAFH,CAEQvC,sBAFR,EAEgC;AAAEsC,QAAAA,KAAK,EAALA;AAAF,OAFhC,EAGGtB,IAHH,CAGQ,UAAAC,GAAG,EAAI;AACX,cAAKR,QAAL,CAAc;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAAd;;AACAR,QAAAA,KAAK,CAACsC,OAAN,CAAc,uCAAd;AACD,OANH,EAOGhB,KAPH,CAOS,UAAAC,GAAG,EAAI;AACZ,cAAKhB,QAAL,CAAc;AAAEiB,UAAAA,KAAK,EAAED,GAAT;AAAcf,UAAAA,OAAO,EAAE;AAAvB,SAAd;;AACAR,QAAAA,KAAK,CAACwB,KAAN,CAAY,gDAAZ;AACD,OAVH;AAWD,KA5FkB;;AAEjB,UAAKf,KAAL,GAAa;AACXD,MAAAA,OAAO,EAAE,KADE;AAEXgB,MAAAA,KAAK,EAAE,IAFI;AAGXH,MAAAA,UAAU,EAAE,EAHD;AAIX;AACAF,MAAAA,OAAO,EAAE,IALE;AAMXT,MAAAA,MAAM,EAAE,CANG;AAOXC,MAAAA,KAAK,EAAE,CAPI;AAQXC,MAAAA,KAAK,EAAE,KARI;AASXI,MAAAA,aAAa,EAAE;AATJ,KAAb;;AAWAuB,IAAAA,MAAM,CAACC,QAAP,GAAkB,YAAM;AAAA;AAAA,UAEpBlC,UAFoB,yBAEpBA,UAFoB;AAAA,yDAGpBG,KAHoB;AAAA,UAGXe,KAHW,0BAGXA,KAHW;AAAA,UAGJhB,OAHI,0BAGJA,OAHI;AAAA,UAGKW,OAHL,0BAGKA,OAHL;;AAKtB,UAAIK,KAAK,IAAIhB,OAAT,IAAoB,CAACW,OAAzB,EAAkC;;AAClC,UACEsB,QAAQ,CAACC,eAAT,CAAyBC,YAAzB,GACEF,QAAQ,CAACC,eAAT,CAAyBE,SAD3B,KAEAH,QAAQ,CAACC,eAAT,CAAyBG,YAH3B,EAIE;AACA;AACAvC,QAAAA,UAAU;AACX;AACF,KAdD;;AAbiB;AA4BlB;;;;yCAEoB;AACnB,WAAKA,UAAL;AACD;;;wCAEmB;AAClBmC,MAAAA,QAAQ,CAACK,cAAT,CAAwB,OAAxB,EAAiCC,YAAjC,CAA8C,MAA9C,OADkB,CAElB;AACD;;;6BAyDQ;AAAA;;AAAA,yBACgC,KAAKtC,KADrC;AAAA,UACCY,UADD,gBACCA,UADD;AAAA,UACaT,KADb,gBACaA,KADb;AAAA,UACoBO,OADpB,gBACoBA,OADpB,EAEP;;AAEA,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,CADF,EAIE,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJF,EAME,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QANF,EAQE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE;AAAI,QAAA,SAAS,EAAC,cAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAFF,EAGE;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAHF,CADF,CADF,CADF,CARF,EAsBGE,UAAU,IACT;AAAS,QAAA,SAAS,EAAC,2CAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGA,UAAU,CAAC2B,GAAX,CAAe,UAAAC,QAAQ;AAAA,eACtB;AAAK,UAAA,GAAG,EAAEA,QAAQ,CAACC,EAAnB;AAAuB,UAAA,SAAS,EAAC,UAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAEE;AAAK,UAAA,SAAS,EAAC,oCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAK,UAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,IAAD;AACE,UAAA,EAAE,YAAKC,OAAO,CAACC,GAAR,CAAYC,UAAjB,qBAAsCJ,QAAQ,CAACC,EAA/C,CADJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAGE;AACE;AACA,UAAA,GAAG,EACD,mFAHJ;AAKE,UAAA,GAAG,EAAC,EALN;AAME,UAAA,SAAS,EAAC,mCANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAHF,CADF,CADF,EAeE;AAAK,UAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAKD,QAAQ,CAACK,IAAd,CADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAAcL,QAAQ,CAACM,YAAvB,CAFF,EAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAJF,EAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAG,UAAA,OAAO,EAAE;AAAA,mBAAM,MAAI,CAACpB,aAAL,CAAmBc,QAAQ,CAACC,EAA5B,CAAN;AAAA,WAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AACE,UAAA,SAAS,EAAC,mBADZ;AAEE,UAAA,KAAK,EAAE;AAAEM,YAAAA,KAAK,EAAE;AAAT,WAFT;AAGE,yBAAY,MAHd,CAIE;AAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,CADF,CALF,CALF,CAfF,CAFF,CADsB;AAAA,OAAvB,CADH,CADF,CADF,CAvBJ,CADF;AA8ED;;;;EAjLwBjE,KAAK,CAACkE,a;;AAoLjC,eAAerD,YAAf","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Helmet } from \"react-helmet\";\nimport \"../../common/index.scss\";\nimport Slider from \"react-slick\";\nimport { Link } from \"react-router-dom\";\nimport { Slider3 } from \"../../../services/script\";\nimport { AddToFavoritePlacesURL } from \"../../../constants\";\nimport { authAxios } from \"../../../authAxios\";\nimport { toast, ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\n\nimport Search from \"./search\";\nimport { placeListURL } from \"../../../constants\";\n\nclass LocalityList extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      error: null,\n      localities: [],\n      // journals: [],\n      hasMore: true,\n      offset: 0,\n      limit: 2,\n      query: \"all\",\n      newLocalities: []\n    };\n    window.onscroll = () => {\n      const {\n        fetchlaces,\n        state: { error, loading, hasMore }\n      } = this;\n      if (error || loading || !hasMore) return;\n      if (\n        document.documentElement.scrollHeight -\n          document.documentElement.scrollTop ===\n        document.documentElement.clientHeight\n      ) {\n        // call some loading method\n        fetchlaces();\n      }\n    };\n  }\n\n  componentWillMount() {\n    this.fetchlaces();\n  }\n\n  componentDidMount() {\n    document.getElementById(\"color\").setAttribute(\"href\", `#`);\n    // this.fetchlaces();\n  }\n\n  fetchlaces = () => {\n    this.setState({ loading: true }, () => {\n      const { offset, limit, query } = this.state;\n      // console.log(query);\n      axios\n        .get(placeListURL + `?limit=${limit}&offset=${offset}&q=${query}`)\n        .then(res => {\n          const newLocalities = res.data.places;\n          const hasMore = res.data.has_more;\n          this.setState({\n            hasMore,\n            loading: false,\n            localities: [...this.state.localities, ...newLocalities],\n            newLocalities: res.data.places,\n            offset: offset + limit\n          });\n        })\n        .catch(err => {\n          this.setState({\n            error: err.message,\n            loading: false\n          });\n        });\n    });\n  };\n\n  setQuery = e => {\n    this.setState({ query: e.target.value });\n    this.callbacktest();\n  };\n\n  callbacktest = () => {\n    console.log(this.state.query);\n  };\n\n  handleSearch = e => {\n    e.preventDefault();\n    this.fetchlaces();\n  };\n\n  addToWishList = place => {\n    this.setState({ loading: true });\n    authAxios\n      // .post(AddToFavoritePlacesURL  { shop })\n      .post(AddToFavoritePlacesURL, { place })\n      .then(res => {\n        this.setState({ loading: false });\n        toast.success(\"This locality added to your favorites\");\n      })\n      .catch(err => {\n        this.setState({ error: err, loading: false });\n        toast.error(\"This locality already exists in your favorites\");\n      });\n  };\n\n  render() {\n    const { localities, query, hasMore } = this.state;\n    // console.log(localities, query, hasMore);\n\n    return (\n      <div>\n        <Helmet>\n          <title>Local Dukans</title>\n        </Helmet>\n        <ToastContainer />\n        {/* <HeaderTwo logoName={\"logo.png\"} /> */}\n        <Search />\n\n        <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"col\">\n              <div className=\"title4\">\n                <br></br>\n                <h2 className=\"title-inner4\"> Localities</h2>\n                <div className=\"line\">\n                  <span></span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {localities && (\n          <section className=\"banner-furniture absolute_banner ratio3_2\">\n            <div className=\"container\">\n              <div className=\"row partition3\">\n                {localities.map(locality => (\n                  <div key={locality.id} className=\"col-md-4\">\n                    {/* <a href={`places/${locality.id}`}> */}\n                    <div className=\"collection-banner p-left text-left\">\n                      <div className=\"img-wrapper\">\n                        <Link\n                          to={`${process.env.PUBLIC_URL}/places/${locality.id}`}\n                        >\n                          <img\n                            // src={`${process.env.PUBLIC_URL}/assets/images/fashion/banner/8.jpg`}\n                            src={\n                              \"https://image.freepik.com/free-photo/river-foggy-mountains-landscape_1204-511.jpg\"\n                            }\n                            alt=\"\"\n                            className=\"img-fluid blur-up lazyload bg-img\"\n                          />\n                        </Link>\n                      </div>\n                      <div className=\"absolute-contain\">\n                        <h3>{locality.name}</h3>\n                        <h4>Village: {locality.village_name}</h4>\n\n                        <br></br>\n                        <div>\n                          {/* <a\n                              href=\"javascript:void(0)\"\n                              title=\"Add to Wishlist\" //\n                            > */}\n                          <span>\n                            <a onClick={() => this.addToWishList(locality.id)}>\n                              <i\n                                className=\"fa fa-heart fa-2x\"\n                                style={{ color: \"#81ba00\" }}\n                                aria-hidden=\"true\"\n                                // onClick={() => this.addToWishList(locality.id)}\n                              ></i>\n                            </a>\n                          </span>\n                          {/* </a> */}\n                        </div>\n                      </div>\n                    </div>\n                    {/* </a> */}\n                  </div>\n                ))}\n              </div>\n            </div>\n          </section>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default LocalityList;\n"]},"metadata":{},"sourceType":"module"}