{"version":3,"sources":["components/ld/orders/order-item.jsx"],"names":["Card","styled","div","_templateObject","FormWrapper","_templateObject2","Form","form","_templateObject3","StyledButton","button","_templateObject4","ProductDetail","_templateObject5","CheckoutHeadingContainer","_templateObject6","OrderItem","state","order","loading","ShopSuccess","CustomerSuccess","error","addressID","orderAddress","orderItems","orderID","shippingCharges","orderTotal","orderStatus","shopOrderStatus","staffOrderStatus","selectedOrderStatus","fetchOrderStatus","authAxios","get","orderStatusListURL","then","res","_this","setState","data","catch","err","fetchOrder","params","props","match","orderDetailURL","address","id","order_items","total","handleCallback","fetchAddress","orderAddressURL","orderCancelCustoemr","e","preventDefault","console","log","put","orderStatusUpdateURL","order_status","toast","handleChangeOrderStatus","status","updateOrderStatus","success","_this2","this","filter","setTimeout","user","is_shop_owner","orderStatusShop","is_staff_user","orderStatusStaff","can_update_by","_this$state","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","react_router_dom__WEBPACK_IMPORTED_MODULE_11__","to","_styled_utils__WEBPACK_IMPORTED_MODULE_16__","react_router_dom__WEBPACK_IMPORTED_MODULE_7__","style","marginRight","marginBottom","react_toastify__WEBPACK_IMPORTED_MODULE_12__","Fragment","onSubmit","react_select__WEBPACK_IMPORTED_MODULE_10__","className","onChange","getOptionLabel","option","concat","name","getOptionValue","options","onInputChange","handleInputChange","placeholder","menuIsOpen","menuOpen","type","map","item","index","key","itemLocalName","itemName","vname","quantity","final_price","coupon","react_bootstrap__WEBPACK_IMPORTED_MODULE_14__","variant","coupon_code","coupon_offer","PlaceName","areaName","full_address","vilalgeName","districtName","stateName","phone_number","href","Component","connect"],"mappings":"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","file":"static/js/36.f2e4c032.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\n// import Breadcrumb from \"../common/breadcrumb\";\nimport { connect } from \"react-redux\";\n// import axios from \"axios\";\nimport { authAxios } from \"../../../authAxios\";\n// import { fetchUser } from \"../../../actions/user\";\nimport Select from \"react-select\";\nimport { Redirect } from \"react-router-dom\";\nimport { ToastContainer, toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { Alert } from \"react-bootstrap\";\nimport styled from \"styled-components\";\nimport { Container } from \"../styled/utils\";\n\nimport {\n  orderDetailURL,\n  orderAddressURL,\n  orderStatusUpdateURL,\n  orderStatusListURL\n} from \"../../../constants\";\n\nconst Card = styled.div`\n  display: flex;\n  flex-direction: column;\n  background-color: #fff;\n  justify-content: center;\n  color: #333;\n  border-radius: 5px;\n  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);\n  padding: 20px;\n  margin: 10px;\n  width: 100%;\n  max-width: 800px;\n`;\n\nconst FormWrapper = styled.div`\n  margin: 20px 5px 5px 20px;\n  padding: 2px;\n\n  /* background-color: #cccccc; */\n`;\n\nexport const Form = styled.form`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst StyledButton = styled.button`\n  display: inline-block;\n  width: 100%;\n  padding: 10px 30px;\n  cursor: pointer;\n  background: #ff4c3b;\n  color: #fff;\n  border: none;\n  border-radius: 5px;\n  border: 1px #fff solid;\n  max-width: 250px;\n`;\n\nconst ProductDetail = styled.div`\n  display: grid;\n  grid-template-columns: 3fr 1fr;\n  height: auto;\n`;\n\nconst CheckoutHeadingContainer = styled.div`\n  padding-top: 20px;\n  padding-bottom: 5px;\n  margin-bottom: 15px;\n  margin: 30px auto 20px auto;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nclass OrderItem extends Component {\n  state = {\n    order: [],\n    loading: false,\n    ShopSuccess: false,\n    CustomerSuccess: false,\n    error: null,\n    addressID: null,\n    orderAddress: [],\n    orderItems: [],\n    orderID: null,\n    shippingCharges: 25,\n    orderTotal: null,\n    orderStatus: [],\n    shopOrderStatus: [],\n    staffOrderStatus: [],\n    selectedOrderStatus: null\n  };\n\n  componentWillMount() {\n    this.fetchOrder();\n    this.fetchOrderStatus();\n    // this.props.fetchUserType();\n    this.filter();\n    setTimeout(() => {\n      this.filter();\n    }, 3000);\n  }\n\n  filter() {\n    if (this.props.user.user.is_shop_owner) {\n      this.orderStatusShop();\n    }\n    if (this.props.user.user.is_staff_user) {\n      this.orderStatusStaff();\n    }\n  }\n\n  orderStatusShop() {\n    const { orderStatus } = this.state;\n    this.setState({\n      shopOrderStatus: this.state.orderStatus.filter(\n        status => status.can_update_by === \"shop\"\n      )\n    });\n  }\n  orderStatusStaff() {\n    const { orderStatus } = this.state;\n    this.setState({\n      staffOrderStatus: this.state.orderStatus.filter(\n        status => status.can_update_by === \"staff\"\n      )\n    });\n  }\n\n  fetchOrderStatus = () => {\n    authAxios\n      .get(orderStatusListURL)\n      .then(res => {\n        // SetOrderStatus(res.data);\n        this.setState({ orderStatus: res.data });\n      })\n      .catch(err => {\n        this.setState({\n          // error: err.message,\n          loading: false\n        });\n      });\n    // });\n  };\n\n  fetchOrder = () => {\n    const {\n      match: { params }\n    } = this.props;\n\n    this.setState({ loading: true });\n    // const { shippingCharges } = this.state;\n    authAxios\n      .get(orderDetailURL(params.orderID))\n      .then(res => {\n        this.setState({\n          order: res.data,\n          loading: false,\n          addressID: res.data.address,\n          orderID: res.data.id,\n          orderItems: res.data.order_items,\n          orderTotal: res.data.total\n        });\n        this.handleCallback();\n      })\n      .catch(err => {\n        this.setState({ error: err, loading: false });\n      });\n  };\n\n  handleCallback = () => {\n    this.fetchAddress();\n  };\n\n  fetchAddress = () => {\n    const { addressID } = this.state;\n    this.setState({ loading: true });\n    authAxios\n      .get(orderAddressURL(addressID))\n      .then(res => {\n        this.setState({ orderAddress: res.data, loading: false });\n      })\n      .catch(err => {\n        this.setState({ error: err, loading: false });\n      });\n  };\n\n  orderCancelCustoemr = e => {\n    e.preventDefault();\n    const { orderID } = this.state;\n    const selectedOrderStatus = 4;\n    console.log(selectedOrderStatus);\n    authAxios\n      .put(orderStatusUpdateURL(orderID), {\n        order_status: selectedOrderStatus\n      })\n      .then(res => {\n        toast.error(\"Order  cancelled\");\n        this.setState({ CustomerSuccess: true });\n      })\n      .catch(err => {\n        this.setState({ error: err });\n      });\n  };\n\n  handleChangeOrderStatus = status => {\n    this.setState({\n      selectedOrderStatus: status.id\n    });\n  };\n\n  updateOrderStatus = e => {\n    e.preventDefault();\n    const { orderID } = this.state;\n    const { selectedOrderStatus } = this.state;\n    authAxios\n      .put(orderStatusUpdateURL(orderID), {\n        order_status: selectedOrderStatus\n      })\n      .then(res => {\n        toast.success(\"Order status updated\");\n        this.setState({ success: true });\n      })\n      .catch(err => {\n        this.setState({ error: err });\n      });\n  };\n\n  render() {\n    const { order, orderAddress, orderItems, success } = this.state;\n    const { user } = this.props;\n    // console.log(user);\n\n    if (success) {\n      if (user.user.is_staff_user) {\n        return <Redirect to=\"/manage-order-delivery\" />;\n      } else if (user.user.is_shop_owner) {\n        return <Redirect to=\"/shop-order-table\" />;\n      } else {\n        return <Redirect to=\"/orders\" />;\n      }\n    }\n\n    return (\n      <Container>\n        <Link\n          style={{ marginRight: \"auto\", marginBottom: \"20px\" }}\n          to={\"/shop-order-table\"}\n        >\n          <StyledButton>Back to orders</StyledButton>\n        </Link>\n        <Card>\n          <ToastContainer />\n          {user.user ? (\n            <>\n              {user.user.is_staff_user ? (\n                <FormWrapper>\n                  <Form onSubmit={this.updateOrderStatus}>\n                    <h3>Update order status</h3>\n                    <Select\n                      className=\"mb-3\"\n                      onChange={this.handleChangeOrderStatus}\n                      getOptionLabel={option => `${option.name}`}\n                      getOptionValue={option => `${option}`}\n                      options={this.state.staffOrderStatus}\n                      onInputChange={this.handleInputChange}\n                      placeholder={\"Select order status\"}\n                      menuIsOpen={this.state.menuOpen}\n                    />\n\n                    <StyledButton type=\"submit\"> Submit</StyledButton>\n                  </Form>\n                </FormWrapper>\n              ) : null}\n              {user.user.is_shop_owner ? (\n                <FormWrapper>\n                  <Form onSubmit={this.updateOrderStatus}>\n                    <h3>Update order status</h3>\n                    <Select\n                      className=\"mb-3\"\n                      onChange={this.handleChangeOrderStatus}\n                      getOptionLabel={option => `${option.name}`}\n                      getOptionValue={option => `${option}`}\n                      options={this.state.shopOrderStatus}\n                      onInputChange={this.handleInputChange}\n                      placeholder={\"Select order status\"}\n                      menuIsOpen={this.state.menuOpen}\n                    />\n\n                    <StyledButton type=\"submit\"> Submit</StyledButton>\n                  </Form>\n                </FormWrapper>\n              ) : null}\n            </>\n          ) : null}\n\n          <CheckoutHeadingContainer>\n            <h2> Product details</h2>\n          </CheckoutHeadingContainer>\n\n          <ProductDetail>\n            <h2>Product</h2>\n            <h4>Price</h4>\n          </ProductDetail>\n\n          {orderItems ? (\n            <>\n              {orderItems.map((item, index) => {\n                return (\n                  <ProductDetail key={index}>\n                    <h6>\n                      {item.itemLocalName ? item.itemLocalName : item.itemName}{\" \"}\n                      [{item.vname}] × {item.quantity}\n                    </h6>\n                    <h6>Rs: {item.final_price}</h6>\n                  </ProductDetail>\n                );\n              })}\n              <ProductDetail>\n                <h4>Total</h4>\n                <h4> Rs: {order.total}</h4>\n              </ProductDetail>\n            </>\n          ) : null}\n\n          {order.coupon ? (\n            <Alert variant={\"success\"}>\n              {order.coupon_code} coupon Applied !!{order.coupon_offer}\n            </Alert>\n          ) : null}\n\n          {orderAddress ? (\n            <>\n              <CheckoutHeadingContainer>\n                <h2> Order Address</h2>\n              </CheckoutHeadingContainer>\n              <>\n                <h2>{orderAddress.PlaceName}</h2>\n                <h4>{orderAddress.areaName}</h4>\n                <h5>{orderAddress.full_address}</h5>\n                <h5>Village: {orderAddress.vilalgeName}</h5>\n                <h5>District: {orderAddress.districtName}</h5>\n                <h5>Sate: {orderAddress.stateName}</h5>\n                <h5>Phone: {orderAddress.phone_number}</h5>\n                <a href={\"tel:\" + orderAddress.phone_number}>\n                  {orderAddress.phone_number}\n                </a>\n              </>\n            </>\n          ) : null}\n        </Card>\n      </Container>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user\n  };\n};\n\nexport default connect(mapStateToProps)(OrderItem);\n"],"sourceRoot":""}